<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<title>Session '{{sessionId}}'</title>
	<script src="/static/js/d3/d3.v3.min.js"></script>
	<script src="/static/js/d3/dagre-d3.min.js"></script>
	<script src="/static/js/dom.js"></script>
	<link  href="/static/css/session.css" rel="stylesheet" type="text/css"/>
	<link href="/static/css/bootstrap.min.css" rel="stylesheet" type="text/css"/>
	<link rel="icon" href="data:;base64,iVBORw0KGgo=">
</head>

<body>
<div class="container">
	<h1>Session {{sessionId}}</h1>
	<h2>Status: <span id="session-status"></span></h2>
	<p>Orientation: <span><input class="direction" type="radio" name="direction" value="LR" id="lr"/><label for="lr">Left to Right</label></span>
	<span><input class="direction" type="radio" name="direction" value="TB" id="tb"/><label for="tb">Top to Bottom</label></span></p>
</div>
<div class="graph">
	<svg><g/></svg>
</div>

<script>

	// Set up zoom support
	var svg = d3.select("svg")
	var inner = svg.select("g")
	var zoom = d3.behavior.zoom().on(
			"zoom",
			function() {
				inner.attr("transform", "translate(" + d3.event.translate + ")"
						+ "scale(" + d3.event.scale + ")");
			});
	svg.call(zoom);

	var render = getRender()
	var g = new dagreD3.graphlib.Graph();
	g.setGraph({
		nodesep : 70,
		ranksep : 50,
		rankdir : "LR", // Left-to-right layout
		marginx : 20,
		marginy : 20
	});

	function drawGraph() {
		inner.call(render, g);
	}

	d3.selectAll('input.direction').on('change', function() {
		direction = d3.event.srcElement.value;
		g.graph().rankdir = direction;
		drawGraph();
	});

	startStatusQuery(g, '{{!serverUrl}}', '{{sessionId}}', 1000)
</script>
</body>
</html>