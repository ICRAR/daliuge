

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>dlg.dropmake &mdash; daliuge 0.2.0 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="dlg.apps" href="apps.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> daliuge
          

          
          </a>

          
            
            
              <div class="version">
                0.2.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../intro.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installing.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../graph_development.html">Graph development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../writing_an_application.html">Application development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples.html">Using the Logical Graph Editor</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../api-index.html">API</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="dlg.html">dlg</a></li>
<li class="toctree-l2"><a class="reference internal" href="manager.html">dlg.manager</a></li>
<li class="toctree-l2"><a class="reference internal" href="apps.html">dlg.apps</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">dlg.dropmake</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-dlg.dropmake.web.lg_web">dlg.dropmake.web.lg_web</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-dlg.dropmake.pg_generator">dlg.dropmake.pg_generator</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-dlg.dropmake.scheduler">dlg.dropmake.scheduler</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-dlg.dropmake.pg_manager">dlg.dropmake.pg_manager</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">daliuge</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../api-index.html">API</a> &raquo;</li>
        
      <li>dlg.dropmake</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/api/dropmake.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-dlg.dropmake">
<span id="dlg-dropmake"></span><h1><a class="toc-backref" href="#id1">dlg.dropmake</a><a class="headerlink" href="#module-dlg.dropmake" title="Permalink to this headline">¶</a></h1>
<p>Prototypical implementation of DataFlow Manager
<a class="reference external" href="https://confluence.ska-sdp.org/display/PRODUCTTREE/C.1.2.4.4+Data+Flow+Manager">https://confluence.ska-sdp.org/display/PRODUCTTREE/C.1.2.4.4+Data+Flow+Manager</a>
The sub-modules are based on the proposed (latest) product tree as of 8 Dec 2015</p>
<div class="contents topic" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#module-dlg.dropmake" id="id1">dlg.dropmake</a></p>
<ul>
<li><p><a class="reference internal" href="#module-dlg.dropmake.web.lg_web" id="id2">dlg.dropmake.web.lg_web</a></p></li>
<li><p><a class="reference internal" href="#module-dlg.dropmake.pg_generator" id="id3">dlg.dropmake.pg_generator</a></p></li>
<li><p><a class="reference internal" href="#module-dlg.dropmake.scheduler" id="id4">dlg.dropmake.scheduler</a></p></li>
<li><p><a class="reference internal" href="#module-dlg.dropmake.pg_manager" id="id5">dlg.dropmake.pg_manager</a></p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="module-dlg.dropmake.web.lg_web">
<span id="dlg-dropmake-web-lg-web"></span><h2><a class="toc-backref" href="#id2">dlg.dropmake.web.lg_web</a><a class="headerlink" href="#module-dlg.dropmake.web.lg_web" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="dlg.dropmake.web.lg_web.save">
<code class="sig-prename descclassname">dlg.dropmake.web.lg_web.</code><code class="sig-name descname">save</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lg_name</span></em>, <em class="sig-param"><span class="n">logical_graph</span></em><span class="sig-paren">)</span><a class="headerlink" href="#dlg.dropmake.web.lg_web.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves graph.</p>
</dd></dl>

</div>
<div class="section" id="module-dlg.dropmake.pg_generator">
<span id="dlg-dropmake-pg-generator"></span><h2><a class="toc-backref" href="#id3">dlg.dropmake.pg_generator</a><a class="headerlink" href="#module-dlg.dropmake.pg_generator" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://confluence.ska-sdp.org/display/PRODUCTTREE/C.1.2.4.4.2+DFM+Resource+Manager">https://confluence.ska-sdp.org/display/PRODUCTTREE/C.1.2.4.4.2+DFM+Resource+Manager</a></p>
<p>DFM resource managr uses the requested logical graphs, the available resources and
the profiling information and turns it into the partitioned physical graph,
which will then be deployed and monitored by the Physical Graph Manager</p>
<p>Examples of logical graph node JSON representation</p>
<dl class="simple">
<dt>{ u’category’: u’Memory’,</dt><dd><p>u’data_volume’: 25,
u’group’: -58,
u’key’: -59,
u’loc’: u’40.96484375000006 -250.53115793863992’,
u’text’: u’Channel &#64;</p>
</dd>
</dl>
<p>All Day’},</p>
<dl class="simple">
<dt>{ u’Arg01’: u’’,</dt><dd><p>u’Arg02’: u’’,
u’Arg03’: u’’,
u’Arg04’: u’’,
u’category’: u’Component’,
u’execution_time’: 20,
u’group’: -60,
u’key’: -56,
u’loc’: u’571.6718750000005 268.0000000000004’,
u’text’: u’DD Calibration’}</p>
</dd>
</dl>
<dl class="py exception">
<dt id="dlg.dropmake.pg_generator.GInvalidLink">
<em class="property">exception </em><code class="sig-prename descclassname">dlg.dropmake.pg_generator.</code><code class="sig-name descname">GInvalidLink</code><a class="headerlink" href="#dlg.dropmake.pg_generator.GInvalidLink" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py exception">
<dt id="dlg.dropmake.pg_generator.GInvalidNode">
<em class="property">exception </em><code class="sig-prename descclassname">dlg.dropmake.pg_generator.</code><code class="sig-name descname">GInvalidNode</code><a class="headerlink" href="#dlg.dropmake.pg_generator.GInvalidNode" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py exception">
<dt id="dlg.dropmake.pg_generator.GPGTException">
<em class="property">exception </em><code class="sig-prename descclassname">dlg.dropmake.pg_generator.</code><code class="sig-name descname">GPGTException</code><a class="headerlink" href="#dlg.dropmake.pg_generator.GPGTException" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py exception">
<dt id="dlg.dropmake.pg_generator.GPGTNoNeedMergeException">
<em class="property">exception </em><code class="sig-prename descclassname">dlg.dropmake.pg_generator.</code><code class="sig-name descname">GPGTNoNeedMergeException</code><a class="headerlink" href="#dlg.dropmake.pg_generator.GPGTNoNeedMergeException" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py exception">
<dt id="dlg.dropmake.pg_generator.GraphException">
<em class="property">exception </em><code class="sig-prename descclassname">dlg.dropmake.pg_generator.</code><code class="sig-name descname">GraphException</code><a class="headerlink" href="#dlg.dropmake.pg_generator.GraphException" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py class">
<dt id="dlg.dropmake.pg_generator.LG">
<em class="property">class </em><code class="sig-prename descclassname">dlg.dropmake.pg_generator.</code><code class="sig-name descname">LG</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">f</span></em>, <em class="sig-param"><span class="n">ssid</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#dlg.dropmake.pg_generator.LG" title="Permalink to this definition">¶</a></dt>
<dd><p>An object representation of Logical Graph</p>
<dl class="py method">
<dt id="dlg.dropmake.pg_generator.LG.lgn_to_pgn">
<code class="sig-name descname">lgn_to_pgn</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lgn</span></em>, <em class="sig-param"><span class="n">iid</span><span class="o">=</span><span class="default_value">'0'</span></em>, <em class="sig-param"><span class="n">lpcxt</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#dlg.dropmake.pg_generator.LG.lgn_to_pgn" title="Permalink to this definition">¶</a></dt>
<dd><p>convert logical graph node to physical graph node
without considering pg links</p>
<p>iid:    instance id (string)
lpcxt:  Loop context</p>
</dd></dl>

<dl class="py method">
<dt id="dlg.dropmake.pg_generator.LG.unroll_to_tpl">
<code class="sig-name descname">unroll_to_tpl</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#dlg.dropmake.pg_generator.LG.unroll_to_tpl" title="Permalink to this definition">¶</a></dt>
<dd><p>Not thread-safe!</p>
<ol class="arabic simple">
<li><p>just create pgn anyway</p></li>
<li><p>sort out the links</p></li>
</ol>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="dlg.dropmake.pg_generator.MetisPGTP">
<em class="property">class </em><code class="sig-prename descclassname">dlg.dropmake.pg_generator.</code><code class="sig-name descname">MetisPGTP</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">drop_list</span></em>, <em class="sig-param"><span class="n">num_partitions</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">min_goal</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">par_label</span><span class="o">=</span><span class="default_value">'Partition'</span></em>, <em class="sig-param"><span class="n">ptype</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">ufactor</span><span class="o">=</span><span class="default_value">10</span></em>, <em class="sig-param"><span class="n">merge_parts</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#dlg.dropmake.pg_generator.MetisPGTP" title="Permalink to this definition">¶</a></dt>
<dd><p>DROP and GOJS representations of Physical Graph Template with Partitions
Based on METIS
<a class="reference external" href="http://glaros.dtc.umn.edu/gkhome/metis/metis/overview">http://glaros.dtc.umn.edu/gkhome/metis/metis/overview</a></p>
<dl class="py method">
<dt id="dlg.dropmake.pg_generator.MetisPGTP.get_partition_info">
<code class="sig-name descname">get_partition_info</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#dlg.dropmake.pg_generator.MetisPGTP.get_partition_info" title="Permalink to this definition">¶</a></dt>
<dd><p>partition parameter and log entry
return a string</p>
</dd></dl>

<dl class="py method">
<dt id="dlg.dropmake.pg_generator.MetisPGTP.merge_partitions">
<code class="sig-name descname">merge_partitions</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">new_num_parts</span></em>, <em class="sig-param"><span class="n">form_island</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">island_type</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">visual</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#dlg.dropmake.pg_generator.MetisPGTP.merge_partitions" title="Permalink to this definition">¶</a></dt>
<dd><p>This is called during resource mapping - deploying partitioned PGT to
a list of nodes</p>
<dl>
<dt>form_island:    If True, the merging will form <cite>new_num_parts</cite> logical</dt><dd><p>islands on top of existing partitions (i.e. nodes). this
is also known as “reference-based merging”</p>
<p>If False, the merging will physically merge current
partitions into <cite>new_num_parts</cite> new partitions (i.e. nodes)
Thus, there will be no node-island ‘hierarchies’ created</p>
</dd>
</dl>
<p>island_type:    integer, 0 - data island, 1 - compute island</p>
</dd></dl>

<dl class="py method">
<dt id="dlg.dropmake.pg_generator.MetisPGTP.to_gojs_json">
<code class="sig-name descname">to_gojs_json</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">string_rep</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">outdict</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">visual</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#dlg.dropmake.pg_generator.MetisPGTP.to_gojs_json" title="Permalink to this definition">¶</a></dt>
<dd><p>Partition the PGT into a real “PGT with Partitions”, thus PGTP, using
METIS built-in functions</p>
<dl class="simple">
<dt>See METIS usage:</dt><dd><p><a class="reference external" href="http://metis.readthedocs.io/en/latest/index.html">http://metis.readthedocs.io/en/latest/index.html</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="dlg.dropmake.pg_generator.MetisPGTP.to_partition_input">
<code class="sig-name descname">to_partition_input</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">outf</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#dlg.dropmake.pg_generator.MetisPGTP.to_partition_input" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert to METIS format for mapping and decomposition
NOTE - Since METIS only supports Undirected Graph, we have to produce
both upstream and downstream nodes to fit its input format</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="dlg.dropmake.pg_generator.MinNumPartsPGTP">
<em class="property">class </em><code class="sig-prename descclassname">dlg.dropmake.pg_generator.</code><code class="sig-name descname">MinNumPartsPGTP</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">drop_list</span></em>, <em class="sig-param"><span class="n">deadline</span></em>, <em class="sig-param"><span class="n">num_partitions</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">par_label</span><span class="o">=</span><span class="default_value">'Partition'</span></em>, <em class="sig-param"><span class="n">max_dop</span><span class="o">=</span><span class="default_value">8</span></em>, <em class="sig-param"><span class="n">merge_parts</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">optimistic_factor</span><span class="o">=</span><span class="default_value">0.5</span></em><span class="sig-paren">)</span><a class="headerlink" href="#dlg.dropmake.pg_generator.MinNumPartsPGTP" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt id="dlg.dropmake.pg_generator.MinNumPartsPGTP.get_partition_info">
<code class="sig-name descname">get_partition_info</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#dlg.dropmake.pg_generator.MinNumPartsPGTP.get_partition_info" title="Permalink to this definition">¶</a></dt>
<dd><p>partition parameter and log entry
return a string</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="dlg.dropmake.pg_generator.MySarkarPGTP">
<em class="property">class </em><code class="sig-prename descclassname">dlg.dropmake.pg_generator.</code><code class="sig-name descname">MySarkarPGTP</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">drop_list</span></em>, <em class="sig-param"><span class="n">num_partitions</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">par_label</span><span class="o">=</span><span class="default_value">'Partition'</span></em>, <em class="sig-param"><span class="n">max_dop</span><span class="o">=</span><span class="default_value">8</span></em>, <em class="sig-param"><span class="n">merge_parts</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#dlg.dropmake.pg_generator.MySarkarPGTP" title="Permalink to this definition">¶</a></dt>
<dd><p>use the MySarkarScheduler to produce the PGTP</p>
<dl class="py method">
<dt id="dlg.dropmake.pg_generator.MySarkarPGTP.get_partition_info">
<code class="sig-name descname">get_partition_info</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#dlg.dropmake.pg_generator.MySarkarPGTP.get_partition_info" title="Permalink to this definition">¶</a></dt>
<dd><p>partition parameter and log entry
return a string</p>
</dd></dl>

<dl class="py method">
<dt id="dlg.dropmake.pg_generator.MySarkarPGTP.merge_partitions">
<code class="sig-name descname">merge_partitions</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">new_num_parts</span></em>, <em class="sig-param"><span class="n">form_island</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">island_type</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">visual</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#dlg.dropmake.pg_generator.MySarkarPGTP.merge_partitions" title="Permalink to this definition">¶</a></dt>
<dd><p>This is called during resource mapping - deploying partitioned PGT to
a list of nodes</p>
<dl>
<dt>form_island:    If True, the merging will form <cite>new_num_parts</cite> logical</dt><dd><p>islands on top of existing partitions (i.e. nodes)</p>
<p>If False, the merging will physically merge current
partitions into <cite>new_num_parts</cite> new partitions (i.e. nodes)
Thus, there will be no node-island ‘hierarchies’ created</p>
</dd>
</dl>
<p>island_type:    integer, 0 - data island, 1 - compute island</p>
</dd></dl>

<dl class="py method">
<dt id="dlg.dropmake.pg_generator.MySarkarPGTP.to_gojs_json">
<code class="sig-name descname">to_gojs_json</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">string_rep</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">outdict</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">visual</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#dlg.dropmake.pg_generator.MySarkarPGTP.to_gojs_json" title="Permalink to this definition">¶</a></dt>
<dd><p>Partition the PGT into a real “PGT with Partitions”, thus PGTP</p>
</dd></dl>

<dl class="py method">
<dt id="dlg.dropmake.pg_generator.MySarkarPGTP.to_partition_input">
<code class="sig-name descname">to_partition_input</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">outf</span></em><span class="sig-paren">)</span><a class="headerlink" href="#dlg.dropmake.pg_generator.MySarkarPGTP.to_partition_input" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert to format for mapping and decomposition</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="dlg.dropmake.pg_generator.PGT">
<em class="property">class </em><code class="sig-prename descclassname">dlg.dropmake.pg_generator.</code><code class="sig-name descname">PGT</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">drop_list</span></em>, <em class="sig-param"><span class="n">build_dag</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#dlg.dropmake.pg_generator.PGT" title="Permalink to this definition">¶</a></dt>
<dd><p>A DROP representation of Physical Graph Template</p>
<dl class="py method">
<dt id="dlg.dropmake.pg_generator.PGT.dag">
<em class="property">property </em><code class="sig-name descname">dag</code><a class="headerlink" href="#dlg.dropmake.pg_generator.PGT.dag" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Return the networkx nx.DiGraph object</p>
</div></blockquote>
<p>The weight of the same edge (u, v) also depends.
If it is called after the partitioning, it could have been zeroed
if both u and v is allocated to the same DropIsland</p>
</dd></dl>

<dl class="py method">
<dt id="dlg.dropmake.pg_generator.PGT.data_movement">
<em class="property">property </em><code class="sig-name descname">data_movement</code><a class="headerlink" href="#dlg.dropmake.pg_generator.PGT.data_movement" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the TOTAL data movement</p>
</dd></dl>

<dl class="py method">
<dt id="dlg.dropmake.pg_generator.PGT.get_opt_num_parts">
<code class="sig-name descname">get_opt_num_parts</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#dlg.dropmake.pg_generator.PGT.get_opt_num_parts" title="Permalink to this definition">¶</a></dt>
<dd><p>dummy for now</p>
</dd></dl>

<dl class="py method">
<dt id="dlg.dropmake.pg_generator.PGT.json">
<em class="property">property </em><code class="sig-name descname">json</code><a class="headerlink" href="#dlg.dropmake.pg_generator.PGT.json" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the JSON string representation of the PGT
for visualisation</p>
</dd></dl>

<dl class="py method">
<dt id="dlg.dropmake.pg_generator.PGT.pred_exec_time">
<code class="sig-name descname">pred_exec_time</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">app_drop_only</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">wk</span><span class="o">=</span><span class="default_value">'weight'</span></em>, <em class="sig-param"><span class="n">force_answer</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#dlg.dropmake.pg_generator.PGT.pred_exec_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Predict execution time using the longest path length</p>
</dd></dl>

<dl class="py method">
<dt id="dlg.dropmake.pg_generator.PGT.to_gojs_json">
<code class="sig-name descname">to_gojs_json</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">string_rep</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">outdict</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">visual</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#dlg.dropmake.pg_generator.PGT.to_gojs_json" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert PGT (without any partitions) to JSON for visualisation in GOJS</p>
<p>Sub-class PGTPs will override this function, and replace this with
actual partitioning, and the visulisation becomes an option</p>
</dd></dl>

<dl class="py method">
<dt id="dlg.dropmake.pg_generator.PGT.to_partition_input">
<code class="sig-name descname">to_partition_input</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">outf</span></em><span class="sig-paren">)</span><a class="headerlink" href="#dlg.dropmake.pg_generator.PGT.to_partition_input" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert to format for mapping and decomposition</p>
</dd></dl>

<dl class="py method">
<dt id="dlg.dropmake.pg_generator.PGT.to_pg_spec">
<code class="sig-name descname">to_pg_spec</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">node_list</span></em>, <em class="sig-param"><span class="n">ret_str</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">num_islands</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">tpl_nodes_len</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="headerlink" href="#dlg.dropmake.pg_generator.PGT.to_pg_spec" title="Permalink to this definition">¶</a></dt>
<dd><p>convert pgt to pg specification, and map that to the hardware resources</p>
<dl>
<dt>node_list:</dt><dd><p>A list of nodes (list), whose length == (num_islands + num_node_mgrs)
We assume that the MasterDropManager’s node is NOT in the node_list</p>
</dd>
<dt>num_islands:</dt><dd><p>&gt;1  - Partitions are “conceptually” clustered into Islands
1   - Partitions MAY BE physically merged without generating islands</p>
<blockquote>
<div><p>depending on the length of node_list</p>
</div></blockquote>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="dlg.dropmake.pg_generator.PSOPGTP">
<em class="property">class </em><code class="sig-prename descclassname">dlg.dropmake.pg_generator.</code><code class="sig-name descname">PSOPGTP</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">drop_list</span></em>, <em class="sig-param"><span class="n">par_label</span><span class="o">=</span><span class="default_value">'Partition'</span></em>, <em class="sig-param"><span class="n">max_dop</span><span class="o">=</span><span class="default_value">8</span></em>, <em class="sig-param"><span class="n">deadline</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">topk</span><span class="o">=</span><span class="default_value">30</span></em>, <em class="sig-param"><span class="n">swarm_size</span><span class="o">=</span><span class="default_value">40</span></em>, <em class="sig-param"><span class="n">merge_parts</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#dlg.dropmake.pg_generator.PSOPGTP" title="Permalink to this definition">¶</a></dt>
<dd><dl class="py method">
<dt id="dlg.dropmake.pg_generator.PSOPGTP.get_partition_info">
<code class="sig-name descname">get_partition_info</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#dlg.dropmake.pg_generator.PSOPGTP.get_partition_info" title="Permalink to this definition">¶</a></dt>
<dd><p>partition parameter and log entry
return a string</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="dlg.dropmake.pg_generator.fill">
<code class="sig-prename descclassname">dlg.dropmake.pg_generator.</code><code class="sig-name descname">fill</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lg</span></em>, <em class="sig-param"><span class="n">params</span></em><span class="sig-paren">)</span><a class="headerlink" href="#dlg.dropmake.pg_generator.fill" title="Permalink to this definition">¶</a></dt>
<dd><p>Logical Graph + params -&gt; Filled Logical Graph</p>
</dd></dl>

<dl class="py function">
<dt id="dlg.dropmake.pg_generator.partition">
<code class="sig-prename descclassname">dlg.dropmake.pg_generator.</code><code class="sig-name descname">partition</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pgt</span></em>, <em class="sig-param"><span class="n">algo</span></em>, <em class="sig-param"><span class="n">num_partitions</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">num_islands</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">partition_label</span><span class="o">=</span><span class="default_value">'partition'</span></em>, <em class="sig-param"><span class="n">show_gojs</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">algo_params</span></em><span class="sig-paren">)</span><a class="headerlink" href="#dlg.dropmake.pg_generator.partition" title="Permalink to this definition">¶</a></dt>
<dd><p>Partitions a Physical Graph Template</p>
</dd></dl>

<dl class="py function">
<dt id="dlg.dropmake.pg_generator.resource_map">
<code class="sig-prename descclassname">dlg.dropmake.pg_generator.</code><code class="sig-name descname">resource_map</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pgt</span></em>, <em class="sig-param"><span class="n">nodes</span></em>, <em class="sig-param"><span class="n">num_islands</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#dlg.dropmake.pg_generator.resource_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Maps a Physical Graph Template <cite>pgt</cite> to <cite>nodes</cite></p>
</dd></dl>

<dl class="py function">
<dt id="dlg.dropmake.pg_generator.unroll">
<code class="sig-prename descclassname">dlg.dropmake.pg_generator.</code><code class="sig-name descname">unroll</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lg</span></em>, <em class="sig-param"><span class="n">oid_prefix</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">zerorun</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">app</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#dlg.dropmake.pg_generator.unroll" title="Permalink to this definition">¶</a></dt>
<dd><p>Unrolls a logical graph</p>
</dd></dl>

</div>
<div class="section" id="module-dlg.dropmake.scheduler">
<span id="dlg-dropmake-scheduler"></span><h2><a class="toc-backref" href="#id4">dlg.dropmake.scheduler</a><a class="headerlink" href="#module-dlg.dropmake.scheduler" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="dlg.dropmake.scheduler.DAGUtil">
<em class="property">class </em><code class="sig-prename descclassname">dlg.dropmake.scheduler.</code><code class="sig-name descname">DAGUtil</code><a class="headerlink" href="#dlg.dropmake.scheduler.DAGUtil" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper functions dealing with DAG</p>
<dl class="py method">
<dt id="dlg.dropmake.scheduler.DAGUtil.build_dag_from_drops">
<em class="property">static </em><code class="sig-name descname">build_dag_from_drops</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">drop_list</span></em>, <em class="sig-param"><span class="n">embed_drop</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">fake_super_root</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#dlg.dropmake.scheduler.DAGUtil.build_dag_from_drops" title="Permalink to this definition">¶</a></dt>
<dd><p>return a networkx Digraph (DAG)
fake_super_root:    whether to create a fake super root node in the DAG</p>
<blockquote>
<div><p>If set to True, it enables edge zero-based
scheduling agorithms to make more aggressive merging</p>
</div></blockquote>
<p>tw - task weight
dw - data weight / volume</p>
</dd></dl>

<dl class="py method">
<dt id="dlg.dropmake.scheduler.DAGUtil.ganttchart_matrix">
<em class="property">static </em><code class="sig-name descname">ganttchart_matrix</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">G</span></em>, <em class="sig-param"><span class="n">topo_sort</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#dlg.dropmake.scheduler.DAGUtil.ganttchart_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a M (# of DROPs) by N (longest path length) matrix</p>
</dd></dl>

<dl class="py method">
<dt id="dlg.dropmake.scheduler.DAGUtil.get_longest_path">
<em class="property">static </em><code class="sig-name descname">get_longest_path</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">G</span></em>, <em class="sig-param"><span class="n">weight</span><span class="o">=</span><span class="default_value">'weight'</span></em>, <em class="sig-param"><span class="n">default_weight</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">show_path</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">topo_sort</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#dlg.dropmake.scheduler.DAGUtil.get_longest_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Ported from:
<a class="reference external" href="https://github.com/networkx/networkx/blob/master/networkx/algorithms/dag.py">https://github.com/networkx/networkx/blob/master/networkx/algorithms/dag.py</a>
Added node weight</p>
<p>Returns the longest path in a DAG
If G has edges with ‘weight’ attribute the edge data are used as weight values.
Parameters
———-
G : NetworkX DiGraph</p>
<blockquote>
<div><p>Graph</p>
</div></blockquote>
<dl class="simple">
<dt>weight<span class="classifier">string (default ‘weight’)</span></dt><dd><p>Edge data key to use for weight</p>
</dd>
<dt>default_weight<span class="classifier">integer (default 1)</span></dt><dd><p>The weight of edges that do not have a weight attribute</p>
</dd>
</dl>
<dl class="simple">
<dt>path<span class="classifier">list</span></dt><dd><p>Longest path</p>
</dd>
<dt>path_length<span class="classifier">float</span></dt><dd><p>The length of the longest path</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="dlg.dropmake.scheduler.DAGUtil.get_max_antichains">
<em class="property">static </em><code class="sig-name descname">get_max_antichains</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">G</span></em><span class="sig-paren">)</span><a class="headerlink" href="#dlg.dropmake.scheduler.DAGUtil.get_max_antichains" title="Permalink to this definition">¶</a></dt>
<dd><p>return a list of antichains with Top-2 lengths</p>
</dd></dl>

<dl class="py method">
<dt id="dlg.dropmake.scheduler.DAGUtil.get_max_dop">
<em class="property">static </em><code class="sig-name descname">get_max_dop</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">G</span></em><span class="sig-paren">)</span><a class="headerlink" href="#dlg.dropmake.scheduler.DAGUtil.get_max_dop" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the maximum degree of parallelism of this DAG
return : int</p>
</dd></dl>

<dl class="py method">
<dt id="dlg.dropmake.scheduler.DAGUtil.get_max_width">
<em class="property">static </em><code class="sig-name descname">get_max_width</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">G</span></em>, <em class="sig-param"><span class="n">weight</span><span class="o">=</span><span class="default_value">'weight'</span></em>, <em class="sig-param"><span class="n">default_weight</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#dlg.dropmake.scheduler.DAGUtil.get_max_width" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the antichain with the maximum “weighted” width of this DAG
weight: float (for example, it could be RAM consumption in GB)
Return : float</p>
</dd></dl>

<dl class="py method">
<dt id="dlg.dropmake.scheduler.DAGUtil.label_schedule">
<em class="property">static </em><code class="sig-name descname">label_schedule</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">G</span></em>, <em class="sig-param"><span class="n">weight</span><span class="o">=</span><span class="default_value">'weight'</span></em>, <em class="sig-param"><span class="n">topo_sort</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#dlg.dropmake.scheduler.DAGUtil.label_schedule" title="Permalink to this definition">¶</a></dt>
<dd><p>for each node, label its start and end time</p>
</dd></dl>

<dl class="py method">
<dt id="dlg.dropmake.scheduler.DAGUtil.metis_part">
<em class="property">static </em><code class="sig-name descname">metis_part</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">G</span></em>, <em class="sig-param"><span class="n">num_partitions</span></em><span class="sig-paren">)</span><a class="headerlink" href="#dlg.dropmake.scheduler.DAGUtil.metis_part" title="Permalink to this definition">¶</a></dt>
<dd><p>Use metis binary executable (instead of library)
This is used only for testing when libmetis halts unexpectedly</p>
</dd></dl>

<dl class="py method">
<dt id="dlg.dropmake.scheduler.DAGUtil.prune_antichains">
<em class="property">static </em><code class="sig-name descname">prune_antichains</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">antichains</span></em><span class="sig-paren">)</span><a class="headerlink" href="#dlg.dropmake.scheduler.DAGUtil.prune_antichains" title="Permalink to this definition">¶</a></dt>
<dd><p>Prune a list of antichains to keep those with Top-2 lengths
antichains is a Generator (not a list!)</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="dlg.dropmake.scheduler.KFamilyPartition">
<em class="property">class </em><code class="sig-prename descclassname">dlg.dropmake.scheduler.</code><code class="sig-name descname">KFamilyPartition</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">gid</span></em>, <em class="sig-param"><span class="n">max_dop</span></em>, <em class="sig-param"><span class="n">global_dag</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#dlg.dropmake.scheduler.KFamilyPartition" title="Permalink to this definition">¶</a></dt>
<dd><p>A special case (K = 1) of the Maximum Weighted K-families based on
the Theorem 3.1 in
<a class="reference external" href="http://fmdb.cs.ucla.edu/Treports/930014.pdf">http://fmdb.cs.ucla.edu/Treports/930014.pdf</a></p>
<dl class="py method">
<dt id="dlg.dropmake.scheduler.KFamilyPartition.add_node">
<code class="sig-name descname">add_node</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">u</span></em><span class="sig-paren">)</span><a class="headerlink" href="#dlg.dropmake.scheduler.KFamilyPartition.add_node" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a single node u to the partition</p>
</dd></dl>

<dl class="py method">
<dt id="dlg.dropmake.scheduler.KFamilyPartition.can_merge">
<code class="sig-name descname">can_merge</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">that</span></em>, <em class="sig-param"><span class="n">u</span></em>, <em class="sig-param"><span class="n">v</span></em><span class="sig-paren">)</span><a class="headerlink" href="#dlg.dropmake.scheduler.KFamilyPartition.can_merge" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="dlg.dropmake.scheduler.MinNumPartsScheduler">
<em class="property">class </em><code class="sig-prename descclassname">dlg.dropmake.scheduler.</code><code class="sig-name descname">MinNumPartsScheduler</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">drop_list</span></em>, <em class="sig-param"><span class="n">deadline</span></em>, <em class="sig-param"><span class="n">max_dop</span><span class="o">=</span><span class="default_value">8</span></em>, <em class="sig-param"><span class="n">dag</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">optimistic_factor</span><span class="o">=</span><span class="default_value">0.5</span></em><span class="sig-paren">)</span><a class="headerlink" href="#dlg.dropmake.scheduler.MinNumPartsScheduler" title="Permalink to this definition">¶</a></dt>
<dd><p>A special type of partition that aims to schedule the DAG on time but at minimum cost.
In this particular case, the cost is the number of partitions that will be generated.
The assumption is # of partitions (with certain DoP) more or less represents resource footprint.</p>
<dl class="py method">
<dt id="dlg.dropmake.scheduler.MinNumPartsScheduler.is_time_critical">
<code class="sig-name descname">is_time_critical</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">u</span></em>, <em class="sig-param"><span class="n">uw</span></em>, <em class="sig-param"><span class="n">unew</span></em>, <em class="sig-param"><span class="n">v</span></em>, <em class="sig-param"><span class="n">vw</span></em>, <em class="sig-param"><span class="n">vnew</span></em>, <em class="sig-param"><span class="n">curr_lpl</span></em>, <em class="sig-param"><span class="n">ow</span></em>, <em class="sig-param"><span class="n">rem_el</span></em><span class="sig-paren">)</span><a class="headerlink" href="#dlg.dropmake.scheduler.MinNumPartsScheduler.is_time_critical" title="Permalink to this definition">¶</a></dt>
<dd><p>This is called ONLY IF either can_add on partition has returned “False”
or the new critical path is longer than the old one at each iteration</p>
<dl class="simple">
<dt>Parameters:</dt><dd><p>u - node u, v - node v, uw - weight of node u, vw - weight of node v
curr_lpl - current longest path length, ow - current edge weight
rem_el - remainig edges to be zeroed
ow - original edge length</p>
</dd>
<dt>Returns:</dt><dd><p>Boolean</p>
</dd>
</dl>
<p>It looks ahead to compute the probability of time being critical
and compares that with the _optimistic_factor
probility = (num of edges need to be zeroed to meet the deadline) /
(num of remaining unzeroed edges)</p>
</dd></dl>

<dl class="py method">
<dt id="dlg.dropmake.scheduler.MinNumPartsScheduler.override_cannot_add">
<code class="sig-name descname">override_cannot_add</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#dlg.dropmake.scheduler.MinNumPartsScheduler.override_cannot_add" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether this scheduler will override the False result from <cite>Partition.can_add()</cite></p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="dlg.dropmake.scheduler.MySarkarScheduler">
<em class="property">class </em><code class="sig-prename descclassname">dlg.dropmake.scheduler.</code><code class="sig-name descname">MySarkarScheduler</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">drop_list</span></em>, <em class="sig-param"><span class="n">max_dop</span><span class="o">=</span><span class="default_value">8</span></em>, <em class="sig-param"><span class="n">dag</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">dump_progress</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#dlg.dropmake.scheduler.MySarkarScheduler" title="Permalink to this definition">¶</a></dt>
<dd><p>Based on “V. Sarkar, Partitioning and Scheduling Parallel Programs for Execution on
Multiprocessors. Cambridge, MA: MIT Press, 1989.”</p>
<p>Main change
We do not order independent tasks within the same cluster. This could blow the cluster, therefore
we allow for a cost constraint on the number of concurrent tasks (e.g. # of cores) within each cluster</p>
<p>Why
1. we only need to topologically sort the DAG once since we do not add new edges in the cluster
2. closer to requirements
3. adjustable for local schedulers</p>
<p>Similar ideas:
<a class="reference external" href="http://stackoverflow.com/questions/3974731">http://stackoverflow.com/questions/3974731</a></p>
<dl class="py method">
<dt id="dlg.dropmake.scheduler.MySarkarScheduler.is_time_critical">
<code class="sig-name descname">is_time_critical</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">u</span></em>, <em class="sig-param"><span class="n">uw</span></em>, <em class="sig-param"><span class="n">unew</span></em>, <em class="sig-param"><span class="n">v</span></em>, <em class="sig-param"><span class="n">vw</span></em>, <em class="sig-param"><span class="n">vnew</span></em>, <em class="sig-param"><span class="n">curr_lpl</span></em>, <em class="sig-param"><span class="n">ow</span></em>, <em class="sig-param"><span class="n">rem_el</span></em><span class="sig-paren">)</span><a class="headerlink" href="#dlg.dropmake.scheduler.MySarkarScheduler.is_time_critical" title="Permalink to this definition">¶</a></dt>
<dd><p>This is called ONLY IF override_cannot_add has returned “True”
Parameters:</p>
<blockquote>
<div><p>u - node u, v - node v, uw - weight of node u, vw - weight of node v
curr_lpl - current longest path length, ow - current edge weight
rem_el - remainig edges to be zeroed
ow - original edge length</p>
</div></blockquote>
<dl class="simple">
<dt>Returns:</dt><dd><p>Boolean</p>
</dd>
</dl>
<p>MySarkarScheduler always returns False</p>
</dd></dl>

<dl class="py method">
<dt id="dlg.dropmake.scheduler.MySarkarScheduler.override_cannot_add">
<code class="sig-name descname">override_cannot_add</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#dlg.dropmake.scheduler.MySarkarScheduler.override_cannot_add" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether this scheduler will override the False result from <cite>Partition.can_add()</cite></p>
</dd></dl>

<dl class="py method">
<dt id="dlg.dropmake.scheduler.MySarkarScheduler.partition_dag">
<code class="sig-name descname">partition_dag</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#dlg.dropmake.scheduler.MySarkarScheduler.partition_dag" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Return a tuple of</dt><dd><ol class="arabic simple">
<li><p>the # of partitions formed (int)</p></li>
<li><p>the parallel time (longest path, int)</p></li>
<li><p>partition time (seconds, float)</p></li>
</ol>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="dlg.dropmake.scheduler.MySarkarScheduler.reduce_partitions">
<code class="sig-name descname">reduce_partitions</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">parts</span></em>, <em class="sig-param"><span class="n">g_dict</span></em>, <em class="sig-param"><span class="n">G</span></em><span class="sig-paren">)</span><a class="headerlink" href="#dlg.dropmake.scheduler.MySarkarScheduler.reduce_partitions" title="Permalink to this definition">¶</a></dt>
<dd><p>further reduce the number of partitions by merging partitions whose max_dop
is less than capacity</p>
<dl class="simple">
<dt>step 1 - sort partition list based on their</dt><dd><p>_max_dop of num_cpus as default</p>
</dd>
<dt>step 2 - enumerate each partition p to see merging</dt><dd><p>between p and its neighbour is feasible</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="dlg.dropmake.scheduler.PSOScheduler">
<em class="property">class </em><code class="sig-prename descclassname">dlg.dropmake.scheduler.</code><code class="sig-name descname">PSOScheduler</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">drop_list</span></em>, <em class="sig-param"><span class="n">max_dop</span><span class="o">=</span><span class="default_value">8</span></em>, <em class="sig-param"><span class="n">dag</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">deadline</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">topk</span><span class="o">=</span><span class="default_value">30</span></em>, <em class="sig-param"><span class="n">swarm_size</span><span class="o">=</span><span class="default_value">40</span></em><span class="sig-paren">)</span><a class="headerlink" href="#dlg.dropmake.scheduler.PSOScheduler" title="Permalink to this definition">¶</a></dt>
<dd><p>Use the Particle Swarm Optimisation to guide the Sarkar algorithm
<a class="reference external" href="https://en.wikipedia.org/wiki/Particle_swarm_optimization">https://en.wikipedia.org/wiki/Particle_swarm_optimization</a></p>
<p>The idea is to let “edgezeroing” becomes the search variable X
The number of dimensions of X is the number of edges in DAG
Possible values for each dimension is a discrete set {1, 2, 3}
where</p>
<blockquote>
<div><p>10 - no zero (2 in base10) + 1
00 - zero w/o linearisation (0 in base10) + 1
01 - zero with linearisation (1 in base10) + 1</p>
</div></blockquote>
<dl class="simple">
<dt>if (deadline is present):</dt><dd><dl class="simple">
<dt>the objective function sets up a partition scheme such that</dt><dd><ol class="arabic simple">
<li><p>DoP constrints for each partiiton are satisfied
based on X[i] value, reject or linearisation</p></li>
<li><p>returns num_of_partitions</p></li>
</ol>
</dd>
<dt>constrain function:</dt><dd><ol class="arabic simple">
<li><p>makespan &lt; deadline</p></li>
</ol>
</dd>
</dl>
</dd>
<dt>else:</dt><dd><dl class="simple">
<dt>the objective function sets up a partition scheme such that</dt><dd><ol class="arabic simple">
<li><p>DoP constrints for each partiiton are satisfied
based on X[i] value, reject or linearisation</p></li>
<li><p>returns makespan</p></li>
</ol>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt id="dlg.dropmake.scheduler.PSOScheduler.constrain_func">
<code class="sig-name descname">constrain_func</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em><span class="sig-paren">)</span><a class="headerlink" href="#dlg.dropmake.scheduler.PSOScheduler.constrain_func" title="Permalink to this definition">¶</a></dt>
<dd><p>Deadline - critical_path &gt;= 0</p>
</dd></dl>

<dl class="py method">
<dt id="dlg.dropmake.scheduler.PSOScheduler.objective_func">
<code class="sig-name descname">objective_func</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span></em><span class="sig-paren">)</span><a class="headerlink" href="#dlg.dropmake.scheduler.PSOScheduler.objective_func" title="Permalink to this definition">¶</a></dt>
<dd><p>x is a list of values, each taking one of the 3 integers: 0,1,2 for an edge
indices of x is identical to the indices in G.edges().sort(key=’weight’)</p>
</dd></dl>

<dl class="py method">
<dt id="dlg.dropmake.scheduler.PSOScheduler.partition_dag">
<code class="sig-name descname">partition_dag</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#dlg.dropmake.scheduler.PSOScheduler.partition_dag" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Returns a tuple of:</dt><dd><ol class="arabic simple">
<li><p>the # of partitions formed (int)</p></li>
<li><p>the parallel time (longest path, int)</p></li>
<li><p>partition time (seconds, float)</p></li>
<li><p>a list of partitions (Partition)</p></li>
</ol>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="dlg.dropmake.scheduler.Partition">
<em class="property">class </em><code class="sig-prename descclassname">dlg.dropmake.scheduler.</code><code class="sig-name descname">Partition</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">gid</span></em>, <em class="sig-param"><span class="n">max_dop</span></em><span class="sig-paren">)</span><a class="headerlink" href="#dlg.dropmake.scheduler.Partition" title="Permalink to this definition">¶</a></dt>
<dd><p>Logical partition, multiple (1 ~ N) of these can be placed onto a single
physical resource unit</p>
<p>Logical partition can be nested, and it somewhat resembles the <cite>dlg.manager.drop_manager</cite></p>
<dl class="py method">
<dt id="dlg.dropmake.scheduler.Partition.add">
<code class="sig-name descname">add</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">u</span></em>, <em class="sig-param"><span class="n">v</span></em>, <em class="sig-param"><span class="n">gu</span></em>, <em class="sig-param"><span class="n">gv</span></em>, <em class="sig-param"><span class="n">sequential</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">global_dag</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#dlg.dropmake.scheduler.Partition.add" title="Permalink to this definition">¶</a></dt>
<dd><p>Add nodes u and/or v to the partition
if sequential is True, break antichains to sequential chains</p>
</dd></dl>

<dl class="py method">
<dt id="dlg.dropmake.scheduler.Partition.add_node">
<code class="sig-name descname">add_node</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">u</span></em>, <em class="sig-param"><span class="n">weight</span></em><span class="sig-paren">)</span><a class="headerlink" href="#dlg.dropmake.scheduler.Partition.add_node" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a single node u to the partition</p>
</dd></dl>

<dl class="py method">
<dt id="dlg.dropmake.scheduler.Partition.can_add">
<code class="sig-name descname">can_add</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">u</span></em>, <em class="sig-param"><span class="n">v</span></em>, <em class="sig-param"><span class="n">gu</span></em>, <em class="sig-param"><span class="n">gv</span></em><span class="sig-paren">)</span><a class="headerlink" href="#dlg.dropmake.scheduler.Partition.can_add" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if nodes u and/or v can join this partition
A node may be rejected due to reasons such as: DoP overflow or
completion time deadline overdue, etc.</p>
</dd></dl>

<dl class="py method">
<dt id="dlg.dropmake.scheduler.Partition.probe_max_dop">
<code class="sig-name descname">probe_max_dop</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">u</span></em>, <em class="sig-param"><span class="n">v</span></em>, <em class="sig-param"><span class="n">unew</span></em>, <em class="sig-param"><span class="n">vnew</span></em>, <em class="sig-param"><span class="n">update</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#dlg.dropmake.scheduler.Partition.probe_max_dop" title="Permalink to this definition">¶</a></dt>
<dd><p>An incremental antichain (which appears significantly more efficient than the networkx antichains)
But only works for DoP, not for weighted width</p>
</dd></dl>

<dl class="py method">
<dt id="dlg.dropmake.scheduler.Partition.remove">
<code class="sig-name descname">remove</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">n</span></em><span class="sig-paren">)</span><a class="headerlink" href="#dlg.dropmake.scheduler.Partition.remove" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove node n from the partition</p>
</dd></dl>

<dl class="py method">
<dt id="dlg.dropmake.scheduler.Partition.schedule">
<em class="property">property </em><code class="sig-name descname">schedule</code><a class="headerlink" href="#dlg.dropmake.scheduler.Partition.schedule" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the schedule assocaited with this partition</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="dlg.dropmake.scheduler.Schedule">
<em class="property">class </em><code class="sig-prename descclassname">dlg.dropmake.scheduler.</code><code class="sig-name descname">Schedule</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dag</span></em>, <em class="sig-param"><span class="n">max_dop</span></em><span class="sig-paren">)</span><a class="headerlink" href="#dlg.dropmake.scheduler.Schedule" title="Permalink to this definition">¶</a></dt>
<dd><p>The scheduling solution with schedule-related properties</p>
<dl class="py method">
<dt id="dlg.dropmake.scheduler.Schedule.efficiency">
<em class="property">property </em><code class="sig-name descname">efficiency</code><a class="headerlink" href="#dlg.dropmake.scheduler.Schedule.efficiency" title="Permalink to this definition">¶</a></dt>
<dd><p>resource usage percentage (integer)</p>
</dd></dl>

<dl class="py method">
<dt id="dlg.dropmake.scheduler.Schedule.schedule_matrix">
<em class="property">property </em><code class="sig-name descname">schedule_matrix</code><a class="headerlink" href="#dlg.dropmake.scheduler.Schedule.schedule_matrix" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Return: a self._lpl x self._max_dop matrix</dt><dd><p>(X - time, Y - resource unit / parallel lane)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="dlg.dropmake.scheduler.Schedule.workload">
<em class="property">property </em><code class="sig-name descname">workload</code><a class="headerlink" href="#dlg.dropmake.scheduler.Schedule.workload" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Return: (integer)</dt><dd><p>the mean # of resource units per time unit consumed by the graph/partition</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="dlg.dropmake.scheduler.Scheduler">
<em class="property">class </em><code class="sig-prename descclassname">dlg.dropmake.scheduler.</code><code class="sig-name descname">Scheduler</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">drop_list</span></em>, <em class="sig-param"><span class="n">max_dop</span><span class="o">=</span><span class="default_value">8</span></em>, <em class="sig-param"><span class="n">dag</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#dlg.dropmake.scheduler.Scheduler" title="Permalink to this definition">¶</a></dt>
<dd><p>Static Scheduling consists of three steps:
1. partition the DAG into an optimal number (M) of partitions</p>
<blockquote>
<div><p>goal - minimising execution time while maintaining intra-partition DoP</p>
</div></blockquote>
<ol class="arabic simple" start="2">
<li><dl class="simple">
<dt>merge partitions into a given number (N) of partitions (if M &gt; N)</dt><dd><p>goal - minimise logical communication cost while maintaining load balancing</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>map each merged partition to a resource unit</dt><dd><p>goal - minimise physical communication cost amongst resource units</p>
</dd>
</dl>
</li>
</ol>
<dl class="py method">
<dt id="dlg.dropmake.scheduler.Scheduler.map_partitions">
<code class="sig-name descname">map_partitions</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#dlg.dropmake.scheduler.Scheduler.map_partitions" title="Permalink to this definition">¶</a></dt>
<dd><p>map logical partitions to physical resources</p>
</dd></dl>

<dl class="py method">
<dt id="dlg.dropmake.scheduler.Scheduler.merge_partitions">
<code class="sig-name descname">merge_partitions</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">num_partitions</span></em>, <em class="sig-param"><span class="n">bal_cond</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="headerlink" href="#dlg.dropmake.scheduler.Scheduler.merge_partitions" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Merge M partitions into N partitions where N &lt; M</dt><dd><p>implemented using METIS for now</p>
</dd>
<dt>bal_cond:  load balance condition (integer):</dt><dd><p>0 - workload, 
1 - CPU count (faster to evaluate than workload)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py exception">
<dt id="dlg.dropmake.scheduler.SchedulerException">
<em class="property">exception </em><code class="sig-prename descclassname">dlg.dropmake.scheduler.</code><code class="sig-name descname">SchedulerException</code><a class="headerlink" href="#dlg.dropmake.scheduler.SchedulerException" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-dlg.dropmake.pg_manager">
<span id="dlg-dropmake-pg-manager"></span><h2><a class="toc-backref" href="#id5">dlg.dropmake.pg_manager</a><a class="headerlink" href="#module-dlg.dropmake.pg_manager" title="Permalink to this headline">¶</a></h2>
<p>Refer to
<a class="reference external" href="https://confluence.ska-sdp.org/display/PRODUCTTREE/C.1.2.4.4.4+DFM+Physical+Graph+Manager">https://confluence.ska-sdp.org/display/PRODUCTTREE/C.1.2.4.4.4+DFM+Physical+Graph+Manager</a></p>
<dl class="py class">
<dt id="dlg.dropmake.pg_manager.PGManager">
<em class="property">class </em><code class="sig-prename descclassname">dlg.dropmake.pg_manager.</code><code class="sig-name descname">PGManager</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">root_dir</span></em><span class="sig-paren">)</span><a class="headerlink" href="#dlg.dropmake.pg_manager.PGManager" title="Permalink to this definition">¶</a></dt>
<dd><p>Physical Graph Manager</p>
<dl class="py method">
<dt id="dlg.dropmake.pg_manager.PGManager.add_pgt">
<code class="sig-name descname">add_pgt</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pgt</span></em>, <em class="sig-param"><span class="n">lg_name</span></em><span class="sig-paren">)</span><a class="headerlink" href="#dlg.dropmake.pg_manager.PGManager.add_pgt" title="Permalink to this definition">¶</a></dt>
<dd><p>Dummy impl. using file system for now (thread safe)
TODO - use proper graph databases to manage all PGTs</p>
<dl class="simple">
<dt>Return:</dt><dd><p>A unique PGT id (handle)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="dlg.dropmake.pg_manager.PGManager.get_gantt_chart">
<code class="sig-name descname">get_gantt_chart</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pgt_id</span></em>, <em class="sig-param"><span class="n">json_str</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#dlg.dropmake.pg_manager.PGManager.get_gantt_chart" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Return:</dt><dd><p>the gantt chart matrix (numarray) given a PGT id</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="dlg.dropmake.pg_manager.PGManager.get_pgt">
<code class="sig-name descname">get_pgt</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pgt_id</span></em><span class="sig-paren">)</span><a class="headerlink" href="#dlg.dropmake.pg_manager.PGManager.get_pgt" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Return:</dt><dd><p>The PGT object given its PGT id</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="dlg.dropmake.pg_manager.PGManager.get_schedule_matrices">
<code class="sig-name descname">get_schedule_matrices</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pgt_id</span></em>, <em class="sig-param"><span class="n">json_str</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="headerlink" href="#dlg.dropmake.pg_manager.PGManager.get_schedule_matrices" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Return:</dt><dd><p>a list of schedule matrices (numarrays) given a PGT id</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="dlg.dropmake.pg_manager.PGUtil">
<em class="property">class </em><code class="sig-prename descclassname">dlg.dropmake.pg_manager.</code><code class="sig-name descname">PGUtil</code><a class="headerlink" href="#dlg.dropmake.pg_manager.PGUtil" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper functions dealing with Physical Graphs</p>
<dl class="py method">
<dt id="dlg.dropmake.pg_manager.PGUtil.vstack_mat">
<em class="property">static </em><code class="sig-name descname">vstack_mat</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">A</span></em>, <em class="sig-param"><span class="n">B</span></em>, <em class="sig-param"><span class="n">separator</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="headerlink" href="#dlg.dropmake.pg_manager.PGUtil.vstack_mat" title="Permalink to this definition">¶</a></dt>
<dd><p>Vertically stack two matrices that may have different # of colums
A:</p>
<blockquote>
<div><p>matrix A (2d numpy array)</p>
</div></blockquote>
<dl class="simple">
<dt>B:</dt><dd><p>matrix B (2d numy array)</p>
</dd>
<dt>separator:</dt><dd><p>whether to add an empty row separator between the two matrices (boolean)</p>
</dd>
<dt>Return:</dt><dd><p>the vertically stacked matrix (2d numpy array)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="apps.html" class="btn btn-neutral float-left" title="dlg.apps" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2016-2020, ICRAR

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>